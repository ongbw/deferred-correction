function ydot = fpu_ode(t, y)
omega = 100;
q = y(1:6, :);
p = y(7:end, :);

qdot = p;

pdot = zeros(size(p));
pdot(1, :) = (q(1, :) - q(4, :)).^3 - (q(2, :) - q(5, :) - q(1, :) - q(4, :)).^3;
pdot(2, :) = (q(2, :) - q(5, :) - q(1, :) - q(4, :)).^3 - (q(3, :) - q(6, :) - q(2, :) - q(5, :)).^3;
pdot(3, :) = (q(3, :) + q(6, :)).^3 + (q(3, :) - q(6, :) - q(2, :) - q(5, :)).^3;
pdot(4, :) = omega^2 * q(4, :) - (q(1, :) - q(4, :)).^3 - (q(2, :) - q(5, :) - q(1, :) - q(4, :)).^3;
pdot(5, :) = omega^2 * q(5, :) - (q(2, :) - q(5, :) - q(1, :) - q(4, :)).^3 - (q(3, :) - q(6, :) - q(2, :) - q(5, :)).^3;
pdot(6, :) = omega^2 * q(6, :) + (q(3, :) + q(6, :)).^3 - (q(3, :) - q(6, :) - q(2, :) - q(5, :)).^3;
pdot = -pdot;

ydot = [qdot; pdot];